{
  "id": 3000083945,
  "type": 1,
  "status": 2,
  "agent_id": 3763909,
  "created_at": "2018-11-13T11:33:58Z",
  "category_id": 155349,
  "folder_id": 3000009541,
  "title": "How do I apply CLI/CLD based routing?",
  "updated_at": "2021-06-10T11:10:26Z",
  "description": "<h2>General info</h2><p><br></p><p>By default Sippy Softswitch allows you to apply only one tariff per Account. \u00a0The tariff is called \"Default\" in the examples below. From time to time, the tech team receives questions of how to configure and use different prices and different routing rules based on CLI (i.e. ANI based routing) or CLD (prefix based routing). \u00a0A configuration of these two solutions is shown below.</p><p><br></p><h2>How to setup ANI/CLI based routing:</h2><p><br></p><p>Task:</p><ul><li>if ANI starts with <strong>123</strong>, then apply <strong>P</strong><strong>remium</strong> prices and route the call to a carrier with <strong>P</strong><strong>remium</strong> quality</li><li>if ANI starts with <strong>456</strong>, then apply <strong>G</strong><strong>old</strong> prices and route the call to a carrier with <strong>G</strong><strong>old</strong> quality</li><li>in other cases, use default prices and routes.</li></ul><p><br></p><p>The setup assumes that you already have an Account which has been assigned a:</p><ol><li><strong>Default Tariff</strong> (i.e. default service plan) with default prices;</li><li><strong>Default Routing Group</strong> with default routes</li></ol><p>(if you don't, please refer to the <a href=\"https://support.sippysoft.com/solution/articles/3000083198-basic-configuration-of-sippy-softswitch-step-by-step-\" rel=\"noreferrer noopener\" target=\"_blank\">Basic setup checklist</a>)</p><p><br></p><p>First of all, you need to open <strong>Authentication Rules</strong> for the Account in question using the popup menu:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384518/original/9wW7rmskRUwN9Rg8yfZdbsgQghJQCKmGkQ?1542107114\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384518/original/9wW7rmskRUwN9Rg8yfZdbsgQghJQCKmGkQ?1542107114\" data-fileid=\"3040384518\" data-uniquekey=\"1542099214646\" style=\"width: 865px; height: 291.695px;\"></p><p><br></p><p>Next, click the <strong>Add</strong> button and define the options for the new authentication rule as below:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384625/original/XDaHjTrB4ubMB4ir09dWOu_COAMGCGyydQ?1542107400\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384625/original/XDaHjTrB4ubMB4ir09dWOu_COAMGCGyydQ?1542107400\" data-fileid=\"3040384625\" data-uniquekey=\"1542099214646\"></p><p><br></p><p>Then, add another authentication rule with a different ANI prefix, tariff and routing group (see below):</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384666/original/H6trJVcov7z4NFAjW9-aEyi3J94gWrym9w?1542107454\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384666/original/H6trJVcov7z4NFAjW9-aEyi3J94gWrym9w?1542107454\" data-fileid=\"3040384666\" data-uniquekey=\"1542099214646\"></p><p><br></p><p>You can see every authentication rule has its own <strong>Tariff</strong> and <strong>Routing Group</strong> (Premium and Gold respectively). \u00a0A CLI translation rule may be required if you need to remove the prefix from the CLI.</p><p><br></p><p>Once it's done, you can check your setup using the Test Dial Plan tool.\u00a0 Here are two examples:</p><p><br></p><p>If ANI starts with <strong>123</strong>:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384746/original/KPfQEG6Tum9rCUhYZ65b0y2hxLIL4YnGvQ?1542107621\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040384746/original/KPfQEG6Tum9rCUhYZ65b0y2hxLIL4YnGvQ?1542107621\" data-fileid=\"3040384746\" data-uniquekey=\"1542099214646\"></p><p><br></p><p>If ANI starts with <strong>456</strong>:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040385299/original/oUAzgeFaD-FmiqWgW_b9lkjIQ9p47ErYcA?1542108723\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040385299/original/oUAzgeFaD-FmiqWgW_b9lkjIQ9p47ErYcA?1542108723\" data-fileid=\"3040385299\" data-uniquekey=\"1542099214646\"></p><p><br></p><h2>How to setup CLD prefix based routing:</h2><p><br></p><p>Task:</p><ul><li>if CLD starts with <strong>444</strong>, then apply <strong>Premium</strong> prices and route the call to a carrier with <strong>Premium</strong> quality</li><li>if CLD starts with <strong>555</strong>, then apply <strong>Gold</strong> prices and route the call to a carrier with <strong>Gold</strong> quality</li><li>in other cases, use default prices and routes</li></ul><p><br></p><p>The setup assumes that you already have an Account which has been assigned a:</p><ol><li><strong>Default Tariff</strong> (i.e. default service plan) with default prices</li><li><strong>Default Routing Group</strong> with default routes</li></ol><p>(if you don't, please refer to the <a href=\"https://support.sippysoft.com/solution/articles/3000083198-basic-configuration-of-sippy-softswitch-step-by-step-\" rel=\"noreferrer noopener\" target=\"_blank\">Basic setup checklist</a>)</p><p><br></p><p>Next, you need to create authentication rules.\u00a0 Add one authentication rule as below:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040383054/original/cEKNwA5yrkOaseP8N4TTERGruMx8sIHlqw?1542104095\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040383054/original/cEKNwA5yrkOaseP8N4TTERGruMx8sIHlqw?1542104095\" data-fileid=\"3040383054\" data-uniquekey=\"1542099214646\"></p><p><br></p><p>Then, add another authentication rule as below:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040383066/original/LHi_M3xwwDRnxcgvwTsig_7NgHcxQCpCWA?1542104157\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040383066/original/LHi_M3xwwDRnxcgvwTsig_7NgHcxQCpCWA?1542104157\" data-fileid=\"3040383066\" data-uniquekey=\"1542099214646\"></p><p><br></p><p>You can see every authentication rule has its own <strong>Tariff</strong> and <strong>Routing Group</strong> (Premium and Gold respectively). \u00a0A CLD translation rule may be required if you need to remove the prefix from CLD.</p><p><br></p><p>Once it's done, you can check your setup using the Test Dial Plan tool.\u00a0 Here are two examples:</p><p><br></p><p>If CLD starts with <strong>444</strong>:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040385320/original/i2tEphorWc5abCwI0OxzqWSkq_L_junhqw?1542108793\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040385320/original/i2tEphorWc5abCwI0OxzqWSkq_L_junhqw?1542108793\" data-fileid=\"3040385320\" data-uniquekey=\"1542099214646\"></p><p><br></p><p>If CLD starts with <strong>555</strong>:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040385335/original/4eDDBRbFoJn_FSztPihA9FOMDlKLgaBJEA?1542108821\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040385335/original/4eDDBRbFoJn_FSztPihA9FOMDlKLgaBJEA?1542108821\" data-fileid=\"3040385335\" data-uniquekey=\"1542099214646\"></p><p><br></p><h2>How to block calls based on either CLI (ANI) or CLD:</h2><p><br></p><p>Task:</p><ul><li>if ANI is \"Anonymous\", then block the call</li><li>if CLD has <strong>less than 10 digits</strong>, then block the call</li><li>in other cases, allow calls using default pricing and routing</li></ul><p><br></p><p>The setup assumes that you already have an account which has been assigned a:</p><ol><li><strong>Default Tariff</strong> (i.e. default service plan) with default prices</li><li><strong>Default Routing Group</strong> with default routes</li></ol><p>(if you don't, please refer to the <a href=\"https://support.sippysoft.com/solution/articles/3000083198-basic-configuration-of-sippy-softswitch-step-by-step-\" rel=\"noreferrer noopener\" target=\"_blank\">Basic setup checklist</a>)</p><p><br></p><p>First of all, you need to create an authentication rule which will filter all calls that have a CLD <strong>shorter or longer than 10 digits</strong>:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387426/original/ZUXLFAjMPD658jA2pv-ywiuKBBD7xFAoLA?1542113366\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387426/original/ZUXLFAjMPD658jA2pv-ywiuKBBD7xFAoLA?1542113366\" data-fileid=\"3040387426\" data-uniquekey=\"1542111710180\"></p><p><br></p><p>The translation rule is:</p><pre contenteditable=\"false\" data-code-brush=\"js\" rel=\"highlighter\">s/^(\\d{,9}|\\d{11,})$/BLOCK/</pre><p><br></p><p>Next, you need to add an authentication rule that will match all anonymous calls:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387664/original/O04BnN1GQhPBi-V0c_VbCZRLa6-3HiN1Tw?1542113677\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387664/original/O04BnN1GQhPBi-V0c_VbCZRLa6-3HiN1Tw?1542113677\" data-fileid=\"3040387664\" data-uniquekey=\"1542111710180\"></p><p><br></p><p>Once the rules are added, check how your setup works.\u00a0</p><p><br></p><p>He is an example of a call to a CLD that contains 11 digits:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387830/original/U98-ovB9WrEvKmlU7M3KtjreVnoabApf0w?1542113991\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387830/original/U98-ovB9WrEvKmlU7M3KtjreVnoabApf0w?1542113991\" data-fileid=\"3040387830\" data-uniquekey=\"1542111710180\"></p><p><br></p><p>Here is an example of a call from Anonymous CLI:</p><p><img class=\"fr-dib fr-fil fr-bordered\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387963/original/ZGaFwjFK9goHGZCDk3d3NggQvCu6JHkd3w?1542114255\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3040387963/original/ZGaFwjFK9goHGZCDk3d3NggQvCu6JHkd3w?1542114255\" data-fileid=\"3040387963\" data-uniquekey=\"1542111710180\"></p><p><br></p><p><br></p><h2>Summary</h2><p><br></p><p>The examples provided above cover very simple use-cases in order to show you how to split traffic with prefixes. \u00a0Your requirements may be more complicated. \u00a0For example, in cases where more than two prefixes are required or where a verification of CLI/CLD length is needed, you can add as many authentication rules as are needed.</p><p><br></p><h2>Useful links</h2><ol><li><a href=\"https://support.sippysoft.com/solution/articles/77553-understanding-authentication\" rel=\"noreferrer noopener\" target=\"_blank\">Understanding authentication</a></li><li><a href=\"https://support.sippysoft.com/solution/articles/77556-understanding-routing\" rel=\"noreferrer noopener\" target=\"_blank\">Understanding routing</a></li><li><a href=\"https://support.sippysoft.com/solution/articles/77869-understanding-number-translation\" rel=\"noreferrer noopener\" target=\"_blank\">Understanding number translation</a></li><li><a href=\"https://www.youtube.com/watch?v=4yCKu2-z9sE\" rel=\"noreferrer noopener\" target=\"_blank\">Video tutorial: Authentication rules part 1</a></li><li><a href=\"https://www.youtube.com/watch?v=Dow6Co-nahE\" rel=\"noreferrer noopener\" target=\"_blank\">Video tutorial: Authentication rules part 2</a></li><li><a href=\"https://www.youtube.com/user/sippysoft/videos\" rel=\"noreferrer noopener\" target=\"_blank\">All video tutorials</a></li></ol><p><br></p>",
  "description_text": " General info     By default Sippy Softswitch allows you to apply only one tariff per Account. \u00a0The tariff is called \"Default\" in the examples below. From time to time, the tech team receives questions of how to configure and use different prices and different routing rules based on CLI (i.e. ANI based routing) or CLD (prefix based routing). \u00a0A configuration of these two solutions is shown below.     How to setup ANI/CLI based routing:     Task:   if ANI starts with 123, then apply Premium prices and route the call to a carrier with Premium quality  if ANI starts with 456, then apply Gold prices and route the call to a carrier with Gold quality  in other cases, use default prices and routes.      The setup assumes that you already have an Account which has been assigned a:   Default Tariff (i.e. default service plan) with default prices;  Default Routing Group with default routes   (if you don't, please refer to the Basic setup checklist)     First of all, you need to open Authentication Rules for the Account in question using the popup menu:       Next, click the Add button and define the options for the new authentication rule as below:       Then, add another authentication rule with a different ANI prefix, tariff and routing group (see below):       You can see every authentication rule has its own Tariff and Routing Group (Premium and Gold respectively). \u00a0A CLI translation rule may be required if you need to remove the prefix from the CLI.     Once it's done, you can check your setup using the Test Dial Plan tool.\u00a0 Here are two examples:     If ANI starts with 123:       If ANI starts with 456:       How to setup CLD prefix based routing:     Task:   if CLD starts with 444, then apply Premium prices and route the call to a carrier with Premium quality  if CLD starts with 555, then apply Gold prices and route the call to a carrier with Gold quality  in other cases, use default prices and routes      The setup assumes that you already have an Account which has been assigned a:   Default Tariff (i.e. default service plan) with default prices  Default Routing Group with default routes   (if you don't, please refer to the Basic setup checklist)     Next, you need to create authentication rules.\u00a0 Add one authentication rule as below:       Then, add another authentication rule as below:       You can see every authentication rule has its own Tariff and Routing Group (Premium and Gold respectively). \u00a0A CLD translation rule may be required if you need to remove the prefix from CLD.     Once it's done, you can check your setup using the Test Dial Plan tool.\u00a0 Here are two examples:     If CLD starts with 444:       If CLD starts with 555:       How to block calls based on either CLI (ANI) or CLD:     Task:   if ANI is \"Anonymous\", then block the call  if CLD has less than 10 digits, then block the call  in other cases, allow calls using default pricing and routing      The setup assumes that you already have an account which has been assigned a:   Default Tariff (i.e. default service plan) with default prices  Default Routing Group with default routes   (if you don't, please refer to the Basic setup checklist)     First of all, you need to create an authentication rule which will filter all calls that have a CLD shorter or longer than 10 digits:       The translation rule is:  s/^(\\d{,9}|\\d{11,})$/BLOCK/     Next, you need to add an authentication rule that will match all anonymous calls:       Once the rules are added, check how your setup works.\u00a0     He is an example of a call to a CLD that contains 11 digits:       Here is an example of a call from Anonymous CLI:          Summary     The examples provided above cover very simple use-cases in order to show you how to split traffic with prefixes. \u00a0Your requirements may be more complicated. \u00a0For example, in cases where more than two prefixes are required or where a verification of CLI/CLD length is needed, you can add as many authentication rules as are needed.     Useful links   Understanding authentication  Understanding routing  Understanding number translation  Video tutorial: Authentication rules part 1  Video tutorial: Authentication rules part 2  All video tutorials     ",
  "seo_data": {
    "meta_title": "",
    "meta_description": "",
    "meta_keywords": ""
  },
  "tags": [
    "CLI Routing",
    "CLD Routing",
    "CLI/CLD Routing",
    "Routing Options",
    "translations rules",
    "Routing"
  ],
  "attachments": [],
  "cloud_files": [],
  "thumbs_up": 0,
  "thumbs_down": 1,
  "hits": 1142,
  "suggested": 0,
  "feedback_count": 0,
  "collaboration": {
    "convo_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJUeXBlIjoiYXJ0aWNsZSIsIkNvbnZvSWQiOiIzMDAwMDgzOTQ1LWVuIiwiVXNlcklkIjoiMzAxMjA4OTUyNCIsImV4cCI6MTYzNTM3MTAwMn0.gp37H6zqCRRHPLhetAxMvWLNCJsLlhhkTj_Yyeft9NI"
  }
}