{
  "id": 77556,
  "type": 1,
  "status": 2,
  "agent_id": 3763909,
  "created_at": "2013-04-19T15:06:48Z",
  "category_id": 81138,
  "folder_id": 133168,
  "title": "Understanding Routing",
  "updated_at": "2020-05-01T19:31:36Z",
  "description": "<div dir=\"ltr\"><h3><span style=\"font-size: 18px;\">Understanding Routing</span></h3><p><br></p><p>When the system needs to route a call it has to find a set of Connections which can accept it. \u00a0Finding a set of connections to accept the call takes place in three stages:</p><ol><li>The system starts the process by determining the specific Routing Group that the call should be routed to; this is achieved by finding an entity (i.e. Account or Customer) directly associated with the Root Customer which is responsible for the call and retrieving its Routing Group setting</li><li>At the second stage the system finds all Destination Sets in that Routing Group that have at least one Route matching the destination number. The Route with longest matching prefix is selected from each of those Destination Sets and paired with the Connection that has been associated with that Destination Set in the Routing Group. For example when the destination number is 1234567890, and there are two Destination Sets having Routes with prefixes 1, 12 and 123, 1234 respectively, the system will select Routes with prefixes 12 and 1234.</li><li>The resulting Route / Connection list is ordered based on the Routing Policy settings for the particular Routing Group.\u00a0</li></ol><p>Available policies are:</p><ul><li><em><strong>Least Cos</strong></em>t - Routes are ordered based on cost to the particular destination. Those with the lowest cost will be first</li><li><strong><em>Prefix Length</em></strong> - Routes are ordered based on prefix length. Those that have the longest prefix will be first</li><li><em><strong>Route Preference</strong></em> \u2013 Routes are ordered based on the Preference parameter. Routes with a higher Preference will be first</li><li><em><strong>Routing Entries Order</strong></em> - Routes are ordered based on the Routing Entries order in the each Routing Group. Routes coming from Destination Sets with lower Order number will be first</li></ul><p><br><strong>NOTE</strong>: unlike with Rates, where only one best matching Rate can  be selected, the system will select several Routes for the same destination number, point to the different Connections and try them one-by-one until the call is either connected or all possible Connections have been tried.<br><br>After the list of possible Routes has been built, the Softswitch will try to send the call to the Connections associated with each of those Routes; one by one until the call is either successfully connected or there are no more Connections to try.<br><br>Consider the following example: you have two terminating providers, A and B. \u00a0Provider A can terminate prefixes 1234 and 1345, while Provider B can terminate prefixes 1345 and 1456. \u00a0Prices for termination to prefix 1345 provided by B are lower than prices offered by A, but the quality of termination is higher with provider B. In this case your configuration might look like this::</p><p><br></p><p style=\"text-align: center;\"><img style=\"cursor: default;\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/5029117/original/1.jpg?1366617836\" class=\"fr-dii\"></p><p><br></p><p>Then, if the Routing Group policy is set to Least Cost the switch will send call to number 1-345-567-8901 to Connection \u201c1\u201d first and only if that fails then to Connection \u201c2\u201d. \u00a0However, if the Routing Group policy is set to Route Preference, the switch will try Connection \u201c2\u201d first and only then Connection \u201c1\u201d.<br><br>There are several other parameters that affect routing associated with each Route:</p><ul><li><em><strong>Forbidden</strong></em> \u2013 this parameter if set, instructs the Softswitch not to send any calls with a matching prefix to the Connections associated with the Destination Set</li><li><em><strong>Huntstop</strong></em> \u2013 this parameter if set, instructs the Softswitch to stop hunting routes when the Connection associated with the Route has been reached in the process of searching. \u00a0A failure code will be returned to the caller if the attempt to send the call into the Connection fails</li><li><strong><em>1xx timeout and 2xx timeout</em></strong> - two timeout parameters, allow limiting the amount of time the Softswitch waits for the call to be answered before sending the call over to the next available Connection. \u00a0The first timeout, called 1xx timeout, limits the amount of time the switch waits for any session progress response from the Connection (typically 180 Ringing or 183 Session Progress), it allows for detection of non-functional or unreachable Connections. \u00a0The second timeout, 2xx timeout, limits the amount of time the switch will wait for the call to be answered before trying to send it to the next available Connection. \u00a0The timeouts work concurrently so that whichever happens first \u201cwins\u201d.</li></ul><p><img class=\"fr-dib\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3029605166/original/352hti1rtmdaRsnNmCv27dpYts11Mbo7yQ.png?1498735619\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3029605166/original/352hti1rtmdaRsnNmCv27dpYts11Mbo7yQ.png?1498735619\" data-fileid=\"3029605166\" data-uniquekey=\"1498735606243\" style=\"width: 440px; height: 135.461px;\"></p><ul><li><strong>Final 2xx Timeout, sec -</strong> this parameter allows setting the 2xx timeout for the last routing entry in the Routing Entries and/or Follow Me Entry. \u00a0By default, the 2xx timeout is set to 300 seconds, meaning that Sippy will wait for a \"200 OK\" message on the INVITE up to the <strong>Final 2xx Timeout</strong>. \u00a0The timeout is only applied to the last routing entry in the routing group and/or the last Follow Me Entry. \u00a0The Final 2xx timeout parameter was added from Sippy 4.5 on the Routing Group preferences:</li></ul><img class=\"fr-dib\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3029605140/original/wKh1-wdSgggfgr0l3eJ_Tdr-l5nEhDKHYg.png?1498735511\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3029605140/original/wKh1-wdSgggfgr0l3eJ_Tdr-l5nEhDKHYg.png?1498735511\" data-fileid=\"3029605140\" data-uniquekey=\"1498735441031\" style=\"width: 449px; height: 324.321px;\">Note: all three timers are fired just after sending the INVITE to the vendor. \u00a0For example, with 2xx timeout = 10 seconds, if the Vendor/Connection is not able to connect the call (send a \"200 OK\" message to Sippy) within 10 seconds, the system will drop that Vendor/Connection from the call flow, and either try another Vendor, or drop the call. \u00a0This occurs even if the Vendor replied with first 1xx message at the 9th second of the call.</div>",
  "description_text": "  Understanding Routing     When the system needs to route a call it has to find a set of Connections which can accept it. \u00a0Finding a set of connections to accept the call takes place in three stages:   The system starts the process by determining the specific Routing Group that the call should be routed to; this is achieved by finding an entity (i.e. Account or Customer) directly associated with the Root Customer which is responsible for the call and retrieving its Routing Group setting  At the second stage the system finds all Destination Sets in that Routing Group that have at least one Route matching the destination number. The Route with longest matching prefix is selected from each of those Destination Sets and paired with the Connection that has been associated with that Destination Set in the Routing Group. For example when the destination number is 1234567890, and there are two Destination Sets having Routes with prefixes 1, 12 and 123, 1234 respectively, the system will select Routes with prefixes 12 and 1234.  The resulting Route / Connection list is ordered based on the Routing Policy settings for the particular Routing Group.\u00a0   Available policies are:   Least Cost - Routes are ordered based on cost to the particular destination. Those with the lowest cost will be first  Prefix Length - Routes are ordered based on prefix length. Those that have the longest prefix will be first  Route Preference \u2013 Routes are ordered based on the Preference parameter. Routes with a higher Preference will be first  Routing Entries Order - Routes are ordered based on the Routing Entries order in the each Routing Group. Routes coming from Destination Sets with lower Order number will be first    NOTE: unlike with Rates, where only one best matching Rate can  be selected, the system will select several Routes for the same destination number, point to the different Connections and try them one-by-one until the call is either connected or all possible Connections have been tried.  After the list of possible Routes has been built, the Softswitch will try to send the call to the Connections associated with each of those Routes; one by one until the call is either successfully connected or there are no more Connections to try.  Consider the following example: you have two terminating providers, A and B. \u00a0Provider A can terminate prefixes 1234 and 1345, while Provider B can terminate prefixes 1345 and 1456. \u00a0Prices for termination to prefix 1345 provided by B are lower than prices offered by A, but the quality of termination is higher with provider B. In this case your configuration might look like this::          Then, if the Routing Group policy is set to Least Cost the switch will send call to number 1-345-567-8901 to Connection \u201c1\u201d first and only if that fails then to Connection \u201c2\u201d. \u00a0However, if the Routing Group policy is set to Route Preference, the switch will try Connection \u201c2\u201d first and only then Connection \u201c1\u201d.  There are several other parameters that affect routing associated with each Route:   Forbidden \u2013 this parameter if set, instructs the Softswitch not to send any calls with a matching prefix to the Connections associated with the Destination Set  Huntstop \u2013 this parameter if set, instructs the Softswitch to stop hunting routes when the Connection associated with the Route has been reached in the process of searching. \u00a0A failure code will be returned to the caller if the attempt to send the call into the Connection fails  1xx timeout and 2xx timeout - two timeout parameters, allow limiting the amount of time the Softswitch waits for the call to be answered before sending the call over to the next available Connection. \u00a0The first timeout, called 1xx timeout, limits the amount of time the switch waits for any session progress response from the Connection (typically 180 Ringing or 183 Session Progress), it allows for detection of non-functional or unreachable Connections. \u00a0The second timeout, 2xx timeout, limits the amount of time the switch will wait for the call to be answered before trying to send it to the next available Connection. \u00a0The timeouts work concurrently so that whichever happens first \u201cwins\u201d.      Final 2xx Timeout, sec - this parameter allows setting the 2xx timeout for the last routing entry in the Routing Entries and/or Follow Me Entry. \u00a0By default, the 2xx timeout is set to 300 seconds, meaning that Sippy will wait for a \"200 OK\" message on the INVITE up to the Final 2xx Timeout. \u00a0The timeout is only applied to the last routing entry in the routing group and/or the last Follow Me Entry. \u00a0The Final 2xx timeout parameter was added from Sippy 4.5 on the Routing Group preferences:  Note: all three timers are fired just after sending the INVITE to the vendor. \u00a0For example, with 2xx timeout = 10 seconds, if the Vendor/Connection is not able to connect the call (send a \"200 OK\" message to Sippy) within 10 seconds, the system will drop that Vendor/Connection from the call flow, and either try another Vendor, or drop the call. \u00a0This occurs even if the Vendor replied with first 1xx message at the 9th second of the call. ",
  "seo_data": {
    "meta_title": "",
    "meta_description": "",
    "meta_keywords": ""
  },
  "tags": [
    "Least Cost Route",
    "Prefix Length",
    "Route Preference",
    "Routing"
  ],
  "attachments": [],
  "cloud_files": [],
  "thumbs_up": 9,
  "thumbs_down": 9,
  "hits": 3263,
  "suggested": 0,
  "feedback_count": 0,
  "collaboration": {
    "convo_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJUeXBlIjoiYXJ0aWNsZSIsIkNvbnZvSWQiOiI3NzU1Ni1lbiIsIlVzZXJJZCI6IjMwMTIwODk1MjQiLCJleHAiOjE2MzUzNzEwMjV9.yiIJOWT4o3roOdWsueiZkqc_b-qa9Avq-v1nfwgLYAI"
  }
}