{
  "id": 3000051482,
  "type": 1,
  "status": 2,
  "agent_id": 3901167,
  "created_at": "2016-04-12T08:54:03Z",
  "category_id": 81138,
  "folder_id": 133138,
  "title": "Media relay usage cases",
  "updated_at": "2020-02-14T20:54:45Z",
  "description": "<div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div><p><span id=\"docs-internal-guid-0e02d314-e0de-636b-0202-1c4637211528\" style='font-family: Arial,\"Helvetica Neue\",Helvetica,Arial,sans-serif;'><span style=\"font-size: 15px; color: rgb(34, 34, 34);\">The relay or proxying of media through an intermediary system is useful for such purposes as NAT helping and network topology masking.</span></span></p><p><span id=\"docs-internal-guid-0e02d314-e0de-636b-0202-1c4637211528\" style='font-family: Arial,\"Helvetica Neue\",Helvetica,Arial,sans-serif;'><span style=\"font-size: 15px; color: rgb(34, 34, 34);\"><br></span></span></p><p><span id=\"docs-internal-guid-0e02d314-e0de-636b-0202-1c4637211528\" style='font-family: Arial,\"Helvetica Neue\",Helvetica,Arial,sans-serif;'><span style=\"font-size: 15px; color: rgb(34, 34, 34);\">Relaying media will increase requirements on the network, bandwidth consumption and demand on CPU resources of your system.</span></span></p><p><br></p><p><font size=\"3\">In Sippy there are 3 places to get the RTP proxy configured:</font></p><p><font size=\"3\"><br></font></p><p><strong><font size=\"3\">1. Account level</font></strong></p><p><em><font size=\"3\">Use Media Relay:</font></em></p><p><font size=\"3\">- Never</font></p><p><font size=\"3\">- When Necessary<br></font></p><p><font size=\"3\">- Always</font></p><p><font size=\"3\"><br></font></p><p><strong><font size=\"3\">2. Connection level</font></strong></p><p><em><font size=\"3\">Use Media Relay:</font></em></p><p><font size=\"3\">- Never<br>- When Necessary<br>- Always</font></p><p><em><font size=\"3\">Preferred Media Relay:</font></em></p><p><font size=\"3\">- Built-in\u00a0</font><font size=\"3\">RTPproxy (internal)</font></p><p><font size=\"3\">- SMG (external, if cluster is used)</font></p><p><font size=\"3\"><br></font></p><p><strong><font size=\"3\">3. Routing group level</font></strong></p><p><font size=\"3\"><em>Preferred Media Relay:</em></font></p><p><font size=\"3\">- Built-in RTPproxy (internal)</font></p><p><font size=\"3\">- SMG (external, if cluster is used)</font></p><p><font size=\"3\">- From Connection (inherits the setting on Connection)</font></p><p><font size=\"3\"><br></font></p><p><font size=\"4\"><strong>The main rule here is that if 'Use Media Relay' is set to 'Always' on any level (Account or Connection), the media will be proxied.</strong></font></p><p><br></p><table><thead><tr><th>Account</th><th>Connection</th><th>Effective</th></tr></thead><tbody><tr><td>Never</td><td>Never</td><td><strong>Never</strong></td></tr><tr><td>Never</td><td>When Necessary</td><td><strong>When Necessary *</strong></td></tr><tr><td>Never</td><td>Always</td><td><strong>Always</strong></td></tr><tr><td>Always</td><td>Never</td><td><strong>Always</strong></td></tr><tr><td>Always</td><td>When Necessary</td><td><strong>Always</strong></td></tr><tr><td>Always</td><td>Always</td><td><strong>Always</strong></td></tr><tr><td>When Necessary</td><td>Never</td><td><strong>When Necessary</strong></td></tr><tr><td>When Necessary</td><td>When Necessary</td><td><strong>When Necessary</strong></td></tr><tr><td>When Necessary</td><td>Always</td><td><strong>Always</strong></td></tr></tbody></table><p><br></p><p>* Media Relay would be triggered if the \"Never\" setting is active on the Account, and 'When Necessary\" is set on the Connection for NAT call (only in versions 5.0 and higher).</p><p><br></p><p><strong><font size=\"4\">Usage cases:</font></strong></p><p><br></p><p><font size=\"3\">1. <em>Use Media Relay</em> is set to <u>Always</u> on Account, then RTP would always be proxied even if on Connection the <em>Use Media Relay\u00a0</em>options is set to<em>\u00a0Never</em>.<br></font></p><p><font size=\"3\">The <em>Preferred Media Relay</em> option would be inherited from Routing Group and Connection.</font></p><p><font size=\"3\"><br></font></p><p><font size=\"3\">2. <em>Use Media Relay</em> is set to <u>When Necessary</u> on Account [NAT network case]<br></font></p><p><font size=\"3\">If the call comes from NAT network, then RTP would be proxied no matter what the settings are on Connection for <em>Use Media Relay</em>.</font></p><p><font size=\"3\">The <em>Preferred Media Relay</em> option would be inherited from Routing group and Connection.</font></p><p><font size=\"3\"><br>3. <em>Use Media Relay</em> is set to <u>When Necessary</u> on Account [global network case].<br></font></p><p><font size=\"3\">If the call comes from a global (not NAT) network, then the settings on Connection for <em>Use Media Relay</em> would be checked.<br></font></p><p><font size=\"3\">If <em>Use Media Relay</em> is set to <u>Always</u>, the RTP would be proxied, if it's set to <u>Never/When Necessary</u> - the RTP would not be proxied.<br>The <em>Preferred Media Relay\u00a0</em>option would be inherited from Routing group and Connection if the RTP is proxied.<br></font></p><p><br></p><p><font size=\"3\">4. <em>Use Media Relay</em> is set to <u>Never</u> on Account.<br></font></p><p><font size=\"3\">The settings on Connection for <em>Use Media Relay</em> would be checked.<br></font></p><p><font size=\"3\">If <em>Use Media Relay</em> is set to <u>Always</u>, the RTP would be proxied, if it's set to <u>Never/When Necessary</u> - the RTP would not be proxied.<br>The <em>Preferred Media Relay</em> option would be inherited from Routing group and Connection if the RTP is proxied.</font></p><p><font size=\"3\"><br></font></p><p><font size=\"3\">5. <em>Use Media Relay</em> is set to <u>When Necessary</u> on Connection [NAT network case].<br></font></p><p><font size=\"3\">If the call comes from NAT network,\u00a0</font><font size=\"3\">then the settings on Account for <em>Use Media Relay</em> would be checked.<br></font></p><p><font size=\"3\">If <em>Use Media Relay</em> is set to <u>Always/When Necessary</u>, the RTP would be proxied.</font></p><p><font size=\"3\">If it's set to <u>Never</u> - the RTP would not be proxied (in versions 5.0 or higher, RTP would be proxied, see the table below)<br>The <em>Preferred Media Relay</em> option would be inherited from Routing group and Connection if the RTP is proxied.</font></p><p><br></p><p><font size=\"3\">6. <em>Use Media Relay</em> is set to <u>When Necessary</u> on Connection [global network case].<br></font></p><p><font size=\"3\">If the call comes from a global (not NAT) network, then the settings on Account for <em>Use Media Relay</em> would be checked.<br></font></p><p><font size=\"3\">If <em>Use Media Relay</em> is set to <u>Always</u>, the RTP would be proxied, if it's set to <u>Never/When Necessary</u> - the RTP would not be proxied.<br>The <em>Preferred Media Relay</em> option would be inherited from Routing group and Connection if the RTP is proxied.<br></font></p><p><font size=\"3\"><br></font></p><p><font size=\"3\">7. <em>Use Media Relay</em> is set to <u>Always</u> on Connection,\u00a0</font><span style=\"font-size: medium;\">then RTP would always be proxied even if on Account for <em>Use Media Relay</em> the <u>Never</u> option is set.</span><font size=\"3\"><br>The <em>Preferred Media Relay</em> would be inherited from Routing group and Connection.<br></font></p><p><br></p><p><font size=\"3\">8. <em>Use Media Relay</em> is set to <u>Never</u> o</font><font size=\"3\">n Connection.<br></font></p><p><font size=\"3\">The settings on Account for <em>Use Media Relay</em> would be checked.<br></font></p><p><font size=\"3\">If <em>Use Media Relay</em> is set to <u>Always</u>, the RTP would be proxied, if it's set to <u>Never/When Necessary</u> - the RTP would not be proxied.<br>The <em>Preferred Media Relay</em> option would be inherited from Routing group and Connection if the RTP is proxied.</font></p><p><br></p><p><font size=\"3\">9. Any newly created Account/Connection/Trunk has <u>When Necessary</u> as the default value for <em>Me</em><em>dia Relay</em>.</font></p><p><br></p><p><font size=\"3\">10. The <em>Preferred Media Relay</em> default for a newly created trunk is <em>Built-In RTPProxy</em>.\u00a0</font></p><p><br></p><p><span style=\"font-size: 24px;\"><font size=\"4\"><strong>Onnet Case (</strong>reflects refactored state starting from 5.2 version<strong>):</strong></font></span></p><p><br></p><p><span style=\"font-size: 16px;\">If the call is sent to a <em>Registered Account</em>, the decision whether the call should be proxied is made based on the <em>Use Media Relay</em> setting on the Account used to authenticate the call (<em>Authenticated Account</em>).</span></p><p><br></p><p><span style=\"font-size: 16px;\">If the call is sent to a Trunk, the Use Media Relay setting on the Connection of the Destination (the Trunk) is considered in the decision of whether or not to proxy the call.\u00a0</span></p><p><br></p><p><span style=\"font-size: 16px;\"><strong>The table above is applicable to the onnet case as well.</strong></span></p><span style=\"font-size: 14px;\">* If based on the table the call has to be proxied, the <em>Media Relay</em> setting from the Routing Group of the Authenticated Account would be checked for the RTPProxy, to be used to proxy the call</span></div><div><span style=\"font-size: 14px;\">* If <em>Media Relay</em> is set to From Connection on Routing Group of the Authenticated Account and the call is sent to <em>Trunk</em>, the <em>Media Relay</em> setting from the Connection of the corresponding <em>Trunk</em> would be checked for the RTPProxy to be used to proxy the call.</span></div><p><span style=\"font-size: 14px;\">* If <em>Media Relay</em> is set to From Connection on Routing Group of the Authenticated Account and the call is sent to a Registered Account, the call would be proxied using the\u00a0<em>Built-In RTPProxy.</em></span></p></div></div></div></div></div>",
  "description_text": "       The relay or proxying of media through an intermediary system is useful for such purposes as NAT helping and network topology masking.     Relaying media will increase requirements on the network, bandwidth consumption and demand on CPU resources of your system.     In Sippy there are 3 places to get the RTP proxy configured:     1. Account level  Use Media Relay:  - Never  - When Necessary   - Always     2. Connection level  Use Media Relay:  - Never - When Necessary - Always  Preferred Media Relay:  - Built-in\u00a0RTPproxy (internal)  - SMG (external, if cluster is used)     3. Routing group level  Preferred Media Relay:  - Built-in RTPproxy (internal)  - SMG (external, if cluster is used)  - From Connection (inherits the setting on Connection)     The main rule here is that if 'Use Media Relay' is set to 'Always' on any level (Account or Connection), the media will be proxied.    AccountConnectionEffective Never  Never  Never  Never  When Necessary  When Necessary *  Never  Always  Always  Always  Never  Always  Always  When Necessary  Always  Always  Always  Always  When Necessary  Never  When Necessary  When Necessary  When Necessary  When Necessary  When Necessary  Always  Always     * Media Relay would be triggered if the \"Never\" setting is active on the Account, and 'When Necessary\" is set on the Connection for NAT call (only in versions 5.0 and higher).     Usage cases:     1. Use Media Relay is set to Always on Account, then RTP would always be proxied even if on Connection the Use Media Relay\u00a0options is set to\u00a0Never.   The Preferred Media Relay option would be inherited from Routing Group and Connection.     2. Use Media Relay is set to When Necessary on Account [NAT network case]   If the call comes from NAT network, then RTP would be proxied no matter what the settings are on Connection for Use Media Relay.  The Preferred Media Relay option would be inherited from Routing group and Connection.   3. Use Media Relay is set to When Necessary on Account [global network case].   If the call comes from a global (not NAT) network, then the settings on Connection for Use Media Relay would be checked.   If Use Media Relay is set to Always, the RTP would be proxied, if it's set to Never/When Necessary - the RTP would not be proxied. The Preferred Media Relay\u00a0option would be inherited from Routing group and Connection if the RTP is proxied.      4. Use Media Relay is set to Never on Account.   The settings on Connection for Use Media Relay would be checked.   If Use Media Relay is set to Always, the RTP would be proxied, if it's set to Never/When Necessary - the RTP would not be proxied. The Preferred Media Relay option would be inherited from Routing group and Connection if the RTP is proxied.     5. Use Media Relay is set to When Necessary on Connection [NAT network case].   If the call comes from NAT network,\u00a0then the settings on Account for Use Media Relay would be checked.   If Use Media Relay is set to Always/When Necessary, the RTP would be proxied.  If it's set to Never - the RTP would not be proxied (in versions 5.0 or higher, RTP would be proxied, see the table below) The Preferred Media Relay option would be inherited from Routing group and Connection if the RTP is proxied.     6. Use Media Relay is set to When Necessary on Connection [global network case].   If the call comes from a global (not NAT) network, then the settings on Account for Use Media Relay would be checked.   If Use Media Relay is set to Always, the RTP would be proxied, if it's set to Never/When Necessary - the RTP would not be proxied. The Preferred Media Relay option would be inherited from Routing group and Connection if the RTP is proxied.      7. Use Media Relay is set to Always on Connection,\u00a0then RTP would always be proxied even if on Account for Use Media Relay the Never option is set. The Preferred Media Relay would be inherited from Routing group and Connection.      8. Use Media Relay is set to Never on Connection.   The settings on Account for Use Media Relay would be checked.   If Use Media Relay is set to Always, the RTP would be proxied, if it's set to Never/When Necessary - the RTP would not be proxied. The Preferred Media Relay option would be inherited from Routing group and Connection if the RTP is proxied.     9. Any newly created Account/Connection/Trunk has When Necessary as the default value for Media Relay.     10. The Preferred Media Relay default for a newly created trunk is Built-In RTPProxy.\u00a0     Onnet Case (reflects refactored state starting from 5.2 version):     If the call is sent to a Registered Account, the decision whether the call should be proxied is made based on the Use Media Relay setting on the Account used to authenticate the call (Authenticated Account).     If the call is sent to a Trunk, the Use Media Relay setting on the Connection of the Destination (the Trunk) is considered in the decision of whether or not to proxy the call.\u00a0     The table above is applicable to the onnet case as well. * If based on the table the call has to be proxied, the Media Relay setting from the Routing Group of the Authenticated Account would be checked for the RTPProxy, to be used to proxy the call  * If Media Relay is set to From Connection on Routing Group of the Authenticated Account and the call is sent to Trunk, the Media Relay setting from the Connection of the corresponding Trunk would be checked for the RTPProxy to be used to proxy the call.  * If Media Relay is set to From Connection on Routing Group of the Authenticated Account and the call is sent to a Registered Account, the call would be proxied using the\u00a0Built-In RTPProxy.      ",
  "seo_data": {
    "meta_title": "",
    "meta_description": "",
    "meta_keywords": ""
  },
  "tags": [
    "SMG",
    "Media relay",
    "RTP proxy"
  ],
  "attachments": [],
  "cloud_files": [],
  "thumbs_up": 1,
  "thumbs_down": 0,
  "hits": 1831,
  "suggested": 0,
  "feedback_count": 0,
  "collaboration": {
    "convo_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJUeXBlIjoiYXJ0aWNsZSIsIkNvbnZvSWQiOiIzMDAwMDUxNDgyLWVuIiwiVXNlcklkIjoiMzAxMjA4OTUyNCIsImV4cCI6MTYzNTM3MTAxOX0.BChJuJ9iPEzcWU3t9gNy4aIApIfRj-2PO6Ah3MTJoJE"
  }
}