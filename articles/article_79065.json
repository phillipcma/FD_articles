{
  "id": 79065,
  "type": 1,
  "status": 2,
  "agent_id": 3763909,
  "created_at": "2013-04-25T09:22:44Z",
  "category_id": 82218,
  "folder_id": 134765,
  "title": "2 Way Callback Application",
  "updated_at": "2016-10-12T11:02:09Z",
  "description": "<div dir=\"ltr\">\n<div dir=\"ltr\">\r\n<div dir=\"ltr\">\r\n<div dir=\"ltr\">\r\n<h3><span style=\"font-size: 18px;\">Principle of operation</span></h3>\r\n<p><br></p>\r\n<div>\r\n<p>\r\nThis is an application that user cannot use directly by calling some number. To initiate the application either the <b>XML-RPC interface</b> should be used or a special <b>CLD translation rule</b> on connection can be used or <b>A</b> record should be inserted directly into the <strong>callback_requests</strong> table. <br></p>\r\n<p><br></p>\r\n<p>\r\nThe main use case of the application is as follows.\r\n</p>\r\n<ol>\r\n<li>\n<b>A</b> record via tr. rule or by other means is created in the <strong>callback_requests</strong> table.\r\n</li>\r\n<li>Callback monitor discovers the record and initiates call leg to <strong>original_cli</strong> number with the given identity (<strong>original_cli</strong> as CLI, <strong>username</strong> or <strong>authname</strong> as authname and <strong>md5secret</strong>).\r\n</li>\r\n<li>User picks up his phone.\r\n</li>\r\n<li>2 Way Callback application starts and initiates the call to the <strong>actual CLD</strong> number with the given identity (<strong>username</strong> as CLI, <strong>authname</strong> and <strong>md5secret</strong>). Each of the identity values can be optionally overridden by explicit specification in corresponding field <strong>twoway_cli</strong>, <strong>twoway_authname</strong> and <strong>twoway_md5secret</strong>.\r\n</li>\r\n<li>The phone is picked up at the destination.\r\n</li>\r\n<li>Conversation takes place.\r\n</li>\r\n</ol>\r\n<br>\r\n<h3><span style=\"font-size: 18px;\">Using special CLD translation rule you can initiate a 2 way Callback<br></span></h3>\r\n<p><br></p>\r\n<p>\r\nYou may use a translation rule\r\n to create a 2 way callback request. <br></p>\n<p><br></p>\n<h3><span style=\"font-size: 18px;\">Call routing setup</span></h3>\n<ol>\n<li>Add vendor connection. Set the Asterisk's host/port in the Destination field of Vendor Connection (ex: <b>192.168.0.100:5062</b>).</li>\n<li>Set the CLD Translation Rule for the connection to the value: <b><span style=\"background-color: rgb(216, 216, 216);\">s/.*/ani_2way_&lt;actual CLD&gt;/</span></b>\n</li>\n<li>Add route to this connection.</li>\n</ol>\n<p><i>* For example if a user should be called back and then connected to the \r\nextension 12345 then the CLD translation rule should be look like this:</i><i> </i><span style=\"background-color: rgb(216, 216, 216);\"><i><b>s/.*/ani_2way_12345/</b></i></span><b><span style=\"background-color: rgb(216, 216, 216);\"><i></i></span></b></p>\n<p><br></p>\r\n<h3><span style=\"font-size: 18px;\">Using the callback_requests table directly</span></h3>\r\n<p><br></p>\r\n<p>\r\nLets review the table <strong>callback_requests</strong>, only significant fields.\r\n</p>\r\n<ul>\r\n<li>\r\n<strong>username</strong>, <strong>authname</strong> and <strong>md5secret</strong>  are the identity of the user to use when originating both call legs. The <strong>md5secret</strong>\r\n is HA1 value in hexadecimal representation. HA1 is calculated as MD5 of\r\n the string \"&lt;username&gt;:&lt;realm&gt;:&lt;password&gt;\" (without \r\nquotes).\r\n</li>\r\n<li>\r\n<strong>twoway_cli</strong>, <strong>twoway_authname</strong> and <strong>twoway_md5secret</strong> are optional identity pieces to use when originating second call leg.\r\n</li>\r\n<li>\r\n<strong>original_cli</strong> - The CLI of the user that requested the callback.\r\n</li>\r\n<li>\r\n<strong>original_set_cli</strong> - use this CLI when creating callback call leg.\r\n</li>\r\n<li>\r\n<strong>original_cld</strong> - This field must contain a value in the form <strong>\"2way_&lt;actual CLD&gt;\"</strong>.\r\n</li>\r\n<li>\r\n<strong>next_call</strong> - This field shows the time of the next attempt to call. It may be useful for scheduling the callback in a future.\r\n</li>\r\n<li>\r\n<strong>call_id</strong> - This field can be preset to some \r\nvalue in which case the callback call will use this Call-ID. If the \r\nfield contains NULL then the random value is generated and placed in \r\nthis field during the call.\r\n</li>\r\n<li>\r\n<strong>twoway_call_id</strong> - This field can be preset to \r\nsome value in which case the call to destination will use this Call-ID. \r\nIf the field contains NULL then the default value is constructed based \r\non <strong>call_id</strong> and placed in this field during the call.\r\n</li>\r\n<li>\r\n<strong>status</strong> and <strong>result</strong> - contain current status of the call. More information see <a href=\"http://sippysoft.freshdesk.com/support/solutions/articles/79051-ani-callback-ivr-application\" target=\"_blank\">here</a>\u00a0\r\n</li>\r\n</ul>\r\n<p><br></p>\r\n<p>For example if the user 801 should be called back at extension 87654321 \r\nand then connected to the extension 12345 then the corresponding SQL \r\nquery should look like this: <br></p>\r\n<p><br></p>\r\n\r\n<table id=\"table33888\"><tbody><tr><td><pre>  INSERT INTO callback_requests (\r\n     username, \r\n     authname,\r\n     md5secret,\r\n     original_cli,\r\n     original_cld\r\n  )\r\n  VALUES (\r\n    '801',\r\n    '902',\r\n    '&lt;md5secret&gt;',\r\n    '87654321',\r\n    '2way_12345'\r\n  )</pre></td></tr></tbody></table>\r\n<pre><strong><br>NOTE:</strong> The <strong>authname</strong> value can be omitted in which case the <strong>username</strong> value will be used as an authname instead.\r\n</pre>\r\n\r\n        \r\n        \r\n      </div>\r\n          <h3><br></h3>\r\n<h3>Attachments</h3>\r\n          <ul><li>\r\n      <a href=\"https://trac.sippysoft.com/trac/attachment/wiki/public/IVR/2WayCallback/2way_callback_mysql_dump.sql\" title=\"View attachment\">2way_callback_mysql_dump.sql</a>\r\n      <a href=\"https://trac.sippysoft.com/trac/raw-attachment/wiki/public/IVR/2WayCallback/2way_callback_mysql_dump.sql\" title=\"Download\" class=\"trac-rawlink\"><img src=\"https://trac.sippysoft.com/trac/chrome/common/download.png\" alt=\"Download\"></a>\r\n      (12.3 KB)<q></q>\r\n              </li></ul>\r\n</div>\r\n</div>\r\n</div>\r\n</div>",
  "description_text": " \n \n \n \n Principle of operation \n   \n \n \nThis is an application that user cannot use directly by calling some number. To initiate the application either the XML-RPC interface should be used or a special CLD translation rule on connection can be used or A record should be inserted directly into the callback_requests table.   \n   \n \nThe main use case of the application is as follows.\n \n \n \nA record via tr. rule or by other means is created in the callback_requests table.\n \n Callback monitor discovers the record and initiates call leg to original_cli number with the given identity (original_cli as CLI, username or authname as authname and md5secret).\n \n User picks up his phone.\n \n 2 Way Callback application starts and initiates the call to the actual CLD number with the given identity (username as CLI, authname and md5secret). Each of the identity values can be optionally overridden by explicit specification in corresponding field twoway_cli, twoway_authname and twoway_md5secret.\n \n The phone is picked up at the destination.\n \n Conversation takes place.\n \n \n \n Using special CLD translation rule you can initiate a 2 way Callback  \n   \n \nYou may use a translation rule\n to create a 2 way callback request.   \n   \n Call routing setup \n \n Add vendor connection. Set the Asterisk's host/port in the Destination field of Vendor Connection (ex: 192.168.0.100:5062). \n Set the CLD Translation Rule for the connection to the value: s/.*/ani_2way_<actual CLD>/\n \n Add route to this connection. \n \n * For example if a user should be called back and then connected to the \nextension 12345 then the CLD translation rule should be look like this: s/.*/ani_2way_12345/ \n   \n Using the callback_requests table directly \n   \n \nLets review the table callback_requests, only significant fields.\n \n \n \nusername, authname and md5secret  are the identity of the user to use when originating both call legs. The md5secret\n is HA1 value in hexadecimal representation. HA1 is calculated as MD5 of\n the string \"<username>:<realm>:<password>\" (without \nquotes).\n \n \ntwoway_cli, twoway_authname and twoway_md5secret are optional identity pieces to use when originating second call leg.\n \n \noriginal_cli - The CLI of the user that requested the callback.\n \n \noriginal_set_cli - use this CLI when creating callback call leg.\n \n \noriginal_cld - This field must contain a value in the form \"2way_<actual CLD>\".\n \n \nnext_call - This field shows the time of the next attempt to call. It may be useful for scheduling the callback in a future.\n \n \ncall_id - This field can be preset to some \nvalue in which case the callback call will use this Call-ID. If the \nfield contains NULL then the random value is generated and placed in \nthis field during the call.\n \n \ntwoway_call_id - This field can be preset to \nsome value in which case the call to destination will use this Call-ID. \nIf the field contains NULL then the default value is constructed based \non call_id and placed in this field during the call.\n \n \nstatus and result - contain current status of the call. More information see here\u00a0\n \n \n   \n For example if the user 801 should be called back at extension 87654321 \nand then connected to the extension 12345 then the corresponding SQL \nquery should look like this:   \n   \n\n    INSERT INTO callback_requests (\n     username, \n     authname,\n     md5secret,\n     original_cli,\n     original_cld\n  )\n  VALUES (\n    '801',\n    '902',\n    '<md5secret>',\n    '87654321',\n    '2way_12345'\n  )  \n  NOTE: The authname value can be omitted in which case the username value will be used as an authname instead.\n \n\n        \n        \n       \n             \n Attachments \n            \n      2way_callback_mysql_dump.sql\n      \n      (12.3 KB)\n                \n \n \n \n ",
  "seo_data": {
    "meta_title": "",
    "meta_description": "",
    "meta_keywords": ""
  },
  "tags": [],
  "attachments": [],
  "cloud_files": [],
  "thumbs_up": 0,
  "thumbs_down": 1,
  "hits": 489,
  "suggested": 0,
  "feedback_count": 0,
  "collaboration": {
    "convo_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJUeXBlIjoiYXJ0aWNsZSIsIkNvbnZvSWQiOiI3OTA2NS1lbiIsIlVzZXJJZCI6IjMwMTIwODk1MjQiLCJleHAiOjE2MzUzNzExMjZ9.2-HMYSBwTJBIX4res6mUndEKtrLWLazas2BecmHtQWU"
  }
}