{
  "id": 77553,
  "type": 1,
  "status": 2,
  "agent_id": 3763909,
  "created_at": "2013-04-19T14:50:24Z",
  "category_id": 81138,
  "folder_id": 133168,
  "title": "Understanding Authentication",
  "updated_at": "2021-09-02T20:15:45Z",
  "description": "<div data-identifyelement=\"468\" dir=\"ltr\"><div data-identifyelement=\"469\" dir=\"ltr\"><h1 data-identifyelement=\"470\" style=\"text-align: center;\"><span data-identifyelement=\"471\" style=\"font-size: 18px;\">Understanding Authentication</span></h1><br data-identifyelement=\"472\">Authentication is the process of establishing association between an incoming call and an Account in the system. There are two basic methods for performing Authentication in the Softswitch: using secure SIP digest and using Authentication Rules. The two methods are described in detail below. Note that both methods can be combined together to provide advanced features (see DID assigning example below).</div><div data-identifyelement=\"469\" dir=\"ltr\"><br></div><h2 data-identifyelement=\"469\" dir=\"ltr\"><span dir=\"ltr\" style=\"font-size: 18px; font-family: &quot;Trebuchet MS&quot;, Helvetica, sans-serif;\">Sippy Softswitch uses the following authentication chain sequentially</span></h2><div data-identifyelement=\"469\" dir=\"ltr\"><br></div><div data-identifyelement=\"469\" dir=\"ltr\"><span style=\"font-size: 12px;\"><img src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3061633020/original/AOqLmeIvdqZsymN5dgS_ST3m0IGLhBViCQ.png?1614244489\" style=\"width: auto;\" class=\"fr-fic fr-fil fr-dib fr-bordered\" data-attachment=\"[object Object]\" data-id=\"3061633020\"></span></div><div data-identifyelement=\"469\" dir=\"ltr\"><ul style=\"list-style-type: circle;\"><li dir=\"ltr\" style=\"line-height:1.2;margin-top:0pt;margin-bottom:0pt;\"><span style=\"font-size: 12px;\"><span dir=\"ltr\" style=\"font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">When any call comes into the Softswitch, the very first place the system tries to find an acceptable authentication match is the DID Pool section &nbsp;</span></span></li><li dir=\"ltr\" style=\"line-height:1.2;margin-top:0pt;margin-bottom:0pt;\"><span dir=\"ltr\" style=\"font-size: 12px; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If a match for the incoming call is not found in the DID's authentication rules, the System checks all available authentication rules under Accounts &nbsp;</span></li><li dir=\"ltr\" style=\"line-height:1.2;margin-top:0pt;margin-bottom:0pt;\"><span dir=\"ltr\" style=\"font-size: 12px; font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If there is no matched rule in the authentication rules of any Account, the system sends a \"401 Unauthorized\" response <span dir=\"ltr\" style=\"font-family: Arial; color: rgb(0, 0, 0); background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">to the remote device with a \"WWW-Authenticate\" for the digest authentication</span>&nbsp; &nbsp;</span></li><li dir=\"ltr\" style=\"line-height:1.2;margin-top:0pt;margin-bottom:0pt;\">If the remote end provides the correct credentials for the digest authentication, the system authenticates the call and proceeds with the authorization process.</li></ul><p dir=\"ltr\" style=\"line-height:1.2;margin-top:0pt;margin-bottom:0pt;\"><br></p><h3 data-identifyelement=\"476\"><span data-identifyelement=\"477\" style=\"font-size: 18px;\">Secure SIP Digest-based Authentication</span></h3><p data-identifyelement=\"478\"><br data-identifyelement=\"479\">For this type of authentication, a call is mapped into the Account by performing secure SIP digest authentication. In practice that means that the device or software that originates the call has a username and password configured and that those parameters are matched against the VoIP Login and VoIP Password parameters of all Accounts until a match is found.<br data-identifyelement=\"480\"><br data-identifyelement=\"481\">Only this type of authentication allows a SIP device to register itself with the Softswitch, providing the requirements for receiving on-net calls.<br data-identifyelement=\"482\"><br data-identifyelement=\"483\">The primary use of this Authentication method is to facilitate the connection of SIP phones and ATAs to the softswitch.</p><p data-identifyelement=\"484\"><br data-identifyelement=\"485\"></p><h3 data-identifyelement=\"486\"><span data-identifyelement=\"487\" style=\"font-size: 18px;\">Rules-based Authentication</span></h3><p data-identifyelement=\"488\"><br data-identifyelement=\"489\">For this type of authentication, a call is mapped into the Account by matching four parameters of the incoming call against one or more Authentication Rules associated with the Account. &nbsp;Below are the four parameters matched:</p><ul data-identifyelement=\"490\"><li data-identifyelement=\"491\">IP address of the device or server that originates the call</li><li data-identifyelement=\"492\">Calling Number / ANI (CLI)</li><li data-identifyelement=\"493\">Called Number / Destination Number (CLD)</li><li data-identifyelement=\"494\">Protocol (SIP, H.323, IAX2, Calling Card PIN)</li></ul><p data-identifyelement=\"495\"><br data-identifyelement=\"496\"></p><p data-identifyelement=\"497\">The first three protocols check the match of incoming traffic to the parameter used in the rule. &nbsp;The Calling Card PIN is used only when the IVR application is used, and the card number (PIN) is requested.</p><p data-identifyelement=\"498\">The system first checks the match of the number entered against the username/voip login of any Account in the system. &nbsp;If no match is found, the Authentication Rules, Protocol, and Calling Card PIN are checked for the match.</p><p data-identifyelement=\"499\"><br data-identifyelement=\"500\"></p><p data-identifyelement=\"501\">In order for the call to match the rule, each of the four parameters of the call must match with the appropriate parameter of at least one Authentication Rule. &nbsp;When one parameter or Rule is empty only the remaining parameters are matched against incoming calls (Protocol can never be empty)<br data-identifyelement=\"502\"><br data-identifyelement=\"503\">For example: &nbsp;The first rule will match any call originated from IP address 1.2.3.4, CLI 567890 and any CLD. &nbsp;The second rule will match calls with CLD 123456789 and any CLI coming from any IP.</p><br data-identifyelement=\"504\"><table class=\"wiki\" data-identifyelement=\"505\"><tbody data-identifyelement=\"506\"><tr data-identifyelement=\"507\"><td data-identifyelement=\"508\">#</td><td data-identifyelement=\"509\">Remote IP Address</td><td data-identifyelement=\"510\">Incoming CLI/ANI</td><td data-identifyelement=\"511\">Incoming CLD/DNIS</td></tr><tr data-identifyelement=\"512\"><td data-identifyelement=\"513\">1</td><td data-identifyelement=\"514\">1.2.3.4</td><td data-identifyelement=\"515\">567890</td><td data-identifyelement=\"516\"><br data-identifyelement=\"517\"></td></tr><tr data-identifyelement=\"518\"><td data-identifyelement=\"519\">2</td><td data-identifyelement=\"520\"><br data-identifyelement=\"521\"></td><td data-identifyelement=\"522\"><br data-identifyelement=\"523\"></td><td data-identifyelement=\"524\">123456789</td></tr></tbody></table><br data-identifyelement=\"525\"></div><div data-identifyelement=\"526\" dir=\"ltr\"><br data-identifyelement=\"527\"></div><div data-identifyelement=\"528\" dir=\"ltr\"><span data-identifyelement=\"529\" style=\"font-size: 18px;\"><strong data-identifyelement=\"530\">Regular Expressions use:</strong></span></div><ul data-identifyelement=\"531\"><li data-identifyelement=\"532\"><div data-identifyelement=\"533\" dir=\"ltr\"><strong data-identifyelement=\"534\">Match any sequence of symbols in the whole number</strong></div></li></ul>Using a wildcard (*) in the Incoming CLI and Incoming CLD fields after the number, will result in prefix matching.&nbsp;</div><div data-identifyelement=\"535\" dir=\"ltr\">For example the following modification of the first rule above will match any call originated from IP address 1.2.3.4 and any CLI starting with 567890 (e.g. 567890123).</div><div data-identifyelement=\"536\" dir=\"ltr\"><p data-identifyelement=\"537\"><br data-identifyelement=\"538\"></p><table data-identifyelement=\"539\"><tbody data-identifyelement=\"540\"><tr data-identifyelement=\"541\"><td data-identifyelement=\"542\">#</td><td class=\"current\" data-identifyelement=\"543\">Remote IP Address</td><td data-identifyelement=\"544\"><p class=\"current\" data-identifyelement=\"545\">Incoming CLI/ANI</p></td><td data-identifyelement=\"546\">&nbsp;Incoming CLD/DNIS</td></tr><tr data-identifyelement=\"547\"><td data-identifyelement=\"548\">1</td><td data-identifyelement=\"549\">1.2.3.4</td><td data-identifyelement=\"550\">567890*</td><td data-identifyelement=\"551\"><br data-identifyelement=\"552\"></td></tr></tbody></table><p data-identifyelement=\"553\"><br data-identifyelement=\"554\"></p><div data-identifyelement=\"555\" dir=\"ltr\">Note: a wildcard can match the absence of symbols, so the 567890* rule will match 567890 CLI as well.</div><p data-identifyelement=\"556\"><br data-identifyelement=\"557\"></p><ul data-identifyelement=\"558\"><li data-identifyelement=\"559\"><strong data-identifyelement=\"560\">Match any symbol in any place of the number (starting from version 5.2)</strong></li></ul><p data-identifyelement=\"561\">This pattern can be set in the Incoming CLI and Incoming CLD fields by placing a question mark ('?') within the number. &nbsp;The result will be number matching where the question mark matches any symbol in the incoming number.</p><div data-identifyelement=\"562\" dir=\"ltr\">For example: the rule below will match any call originated from IP address 1.2.3.4 and any CLI that starts with 567, is followed by any symbol, followed by 90 and any other symbol (e.g. 5678901 or 5670903).</div><div data-identifyelement=\"563\" dir=\"ltr\"><p data-identifyelement=\"564\"><br data-identifyelement=\"565\"></p><table data-identifyelement=\"566\"><tbody data-identifyelement=\"567\"><tr data-identifyelement=\"568\"><td data-identifyelement=\"569\">#</td><td class=\"current\" data-identifyelement=\"570\">Remote IP Address</td><td data-identifyelement=\"571\"><p class=\"current\" data-identifyelement=\"572\">Incoming CLI/ANI</p></td><td data-identifyelement=\"573\">&nbsp;Incoming CLD/DNIS</td></tr><tr data-identifyelement=\"574\"><td data-identifyelement=\"575\">1</td><td data-identifyelement=\"576\">1.2.3.4</td><td data-identifyelement=\"577\">567?90?</td><td data-identifyelement=\"578\"><br data-identifyelement=\"579\"></td></tr></tbody></table><div data-identifyelement=\"580\" dir=\"ltr\"><br data-identifyelement=\"581\"></div><div data-identifyelement=\"582\" dir=\"ltr\">Note: the question mark CANNOT match the absence of a symbol, so the 567?90? rule will NOT match either 567890 or 567901 numbers.</div><p data-identifyelement=\"583\"><br data-identifyelement=\"584\"></p><p data-identifyelement=\"585\"><br data-identifyelement=\"586\"></p><p data-identifyelement=\"587\"><span data-identifyelement=\"588\" style=\"font-size: 18px;\"><strong data-identifyelement=\"589\">Weight distribution for authentication rules (Sippy Softswitch v5.2 and before)</strong></span></p></div><p data-identifyelement=\"590\"><br data-identifyelement=\"591\"></p><p data-identifyelement=\"592\">When performing the match against several concurrent Rules, the softswitch also calculates so-called weights for each matching Rule in order to determine the best match. The formula is as follows:</p><p data-identifyelement=\"593\"><br data-identifyelement=\"594\"></p>1. Matching IP address adds 1.0 to the resulting weight<br data-identifyelement=\"595\">2. Matching non-wildcard, CLD or CLI adds 1.5 to the resulting weight<br data-identifyelement=\"596\">3. Matching wildcard, CLD or CLI adds 1.0 to the resulting weight<br data-identifyelement=\"597\">4. For any matching wildcard, CLI or CLD the resulting weight is increased by the length of the matching part divided by 100<br data-identifyelement=\"598\">5. For any question mark, CLI or CLD, the resulting weight is decreased by 0.001 If a wildcard is present in the matching CLI or CLD, the question mark is considered a regular symbol to be added to the weight accordingly<br data-identifyelement=\"599\"><p data-identifyelement=\"600\"><br data-identifyelement=\"601\">For example, if a call from IP address 1.2.3.4, CLI 567890 and CLD 123456789 arrives, the weights would be calculated as follows:</p><p data-identifyelement=\"602\"><br data-identifyelement=\"603\"></p><table data-identifyelement=\"604\"><tbody data-identifyelement=\"605\"><tr data-identifyelement=\"606\"><td data-identifyelement=\"607\">#</td><td data-identifyelement=\"608\">Remote IP Address</td><td class=\"current\" data-identifyelement=\"609\">Incoming CLI/ANI</td><td data-identifyelement=\"610\">Incoming CLD/DNIS</td><td data-identifyelement=\"611\">Weight</td></tr><tr data-identifyelement=\"612\"><td data-identifyelement=\"613\">1</td><td data-identifyelement=\"614\">1.2.3.4</td><td data-identifyelement=\"615\">567890</td><td data-identifyelement=\"616\"><br data-identifyelement=\"617\"></td><td data-identifyelement=\"618\">1.0+1.5=2.5</td></tr><tr data-identifyelement=\"619\"><td data-identifyelement=\"620\">2</td><td data-identifyelement=\"621\"><br data-identifyelement=\"622\"></td><td data-identifyelement=\"623\"><br data-identifyelement=\"624\"></td><td data-identifyelement=\"625\">123456789</td><td data-identifyelement=\"626\">1.5</td></tr><tr data-identifyelement=\"627\"><td data-identifyelement=\"628\">3</td><td data-identifyelement=\"629\">1.2.3.4</td><td data-identifyelement=\"630\">567890*</td><td data-identifyelement=\"631\"><br data-identifyelement=\"632\"></td><td data-identifyelement=\"633\">1.0+1.0+(6/100)=2.06</td></tr><tr data-identifyelement=\"634\"><td data-identifyelement=\"635\">4</td><td data-identifyelement=\"636\"><br data-identifyelement=\"637\"></td><td data-identifyelement=\"638\">567?9*</td><td data-identifyelement=\"639\"><br data-identifyelement=\"640\"></td><td data-identifyelement=\"641\">1-0.001+0.05=1.049</td></tr></tbody></table><p data-identifyelement=\"642\"><br data-identifyelement=\"643\"></p><p data-identifyelement=\"644\"><br data-identifyelement=\"645\"></p><p data-identifyelement=\"646\">Based on the example above, rule 1 would be selected as the best match.&nbsp;</p><p data-identifyelement=\"647\">Note that if there are multiple rules with the same weight that can be considered \"best\" match, they will be rejected (due to ambiguity) if they use an Authentication rule; in this case, only Digest Authentication would be possible. &nbsp;The error message \"401 Unauthorized\" is used when there is ambiguity. &nbsp;</p><p data-identifyelement=\"648\"><br data-identifyelement=\"649\"></p><h3 data-identifyelement=\"650\"><span data-identifyelement=\"651\" style=\"font-size: 18px;\">Typical Applications for Rules-based Authentication</span></h3><p data-identifyelement=\"652\"><br data-identifyelement=\"653\">Rules-based Authentication can accommodate different real-world scenarios. &nbsp;Sample of scenarios and steps to implement them are listed below:</p><ul data-identifyelement=\"654\"><li data-identifyelement=\"655\">VoIP Peering. &nbsp;Enter IP address of your peer\u2019s softswitch into the Remote IP Address field</li><li data-identifyelement=\"656\">PSTN origination. &nbsp;Enter IP address of the gateway into the Remote IP Address field. &nbsp;If there are multiple gateways several rules with different IP addresses can be added</li><li data-identifyelement=\"657\">Assigning DID numbers. &nbsp;DID (Direct Inward Dialing) can be implemented by combining secure SIP digest authentication with one or more Authentication Rules that contain the DID number (as CLD) from the originating gateway. &nbsp;Optionally, the Remote IP Address can be used to only allow calls (considered DID calls) from a specific gateway. &nbsp;It may be necessary to apply a Translation Rule to ensure proper routing of the call to the registered Account.</li></ul><p data-identifyelement=\"658\"><br data-identifyelement=\"659\"></p><h3 data-identifyelement=\"660\"><span data-identifyelement=\"661\" style=\"font-size: 18px;\">Accessing Authentication Rules</span></h3><p data-identifyelement=\"662\"><br data-identifyelement=\"663\">To access the Authentication Rules for a particular Account, navigate to the Account's menu, click on the Actions for specific Account. &nbsp;Authentication Rules is an action relating to the Account.</p><p data-identifyelement=\"664\"><br data-identifyelement=\"665\"></p><p data-identifyelement=\"666\"><img data-identifyelement=\"667\" data-uniquekey=\"1488812374725\" data-fileid=\"3026865528\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3026865528/original/EC2SJJL1ar79Ucb9TM9hBXZJLd_PCnUfkQ.jpg?1488812523\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3026865528/original/EC2SJJL1ar79Ucb9TM9hBXZJLd_PCnUfkQ.jpg?1488812523\" class=\"fr-dib fr-fil\"></p><p data-identifyelement=\"668\"><br data-identifyelement=\"669\"></p><p data-identifyelement=\"670\"><img data-identifyelement=\"671\" data-uniquekey=\"1488809040386\" data-fileid=\"3026863013\" data-filelink=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3026863013/original/VcBj67Re7seNwfpilV9-hw-68UcneiNpHg.jpg?1488809061\" src=\"https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/3026863013/original/VcBj67Re7seNwfpilV9-hw-68UcneiNpHg.jpg?1488809061\" class=\"fr-dib fr-fil\"><br data-identifyelement=\"672\"></p><h2 data-identifyelement=\"673\">Authentication Rules to block Individual Numbers</h2><p data-identifyelement=\"674\">It is possible to manage this yourself, the method is as follows:</p><p data-identifyelement=\"675\"><br data-identifyelement=\"676\"></p><p data-identifyelement=\"677\">Adding a few numbers and maintaining a fairly simple list can be done manually by changing the Authentication Rules for the specific Account. This can be done <strong data-identifyelement=\"678\">PER NUMBER</strong> or by blocking an entire country/city (or carrier) code.</p><p data-identifyelement=\"679\"><br data-identifyelement=\"680\"></p><p data-identifyelement=\"681\">Example if you aimed to block calls going to CLI = 92321234567</p><ol data-identifyelement=\"682\"><li data-identifyelement=\"683\">Create an Account with any Service Plan and Routing Group</li><li data-identifyelement=\"684\">Add an Authentication Rule for the Account that uses CLI = 92321234567<br>if you need to block calls based on NPA/NXX - you can also add a rule such as: 9232* whereby all calls to 9232 xxx xxxx are blocked</li></ol><p data-identifyelement=\"686\">You can also manage Authentication Rules using the XML APIs - the support team can provide you details on the correct XML API syntax.</p><p data-identifyelement=\"687\"><br data-identifyelement=\"688\"></p><p data-identifyelement=\"689\">Note that calls dropped using the method above will show SIP error: \"403 Auth Failed\" and will not be written to the CDRs. &nbsp;</p><p data-identifyelement=\"690\"><br data-identifyelement=\"691\"></p><p data-identifyelement=\"692\">While the solution works in limited numbers we do offer a Do Not Call List module that is far more effective for managing blocked calls. &nbsp;You can read up more about this solution <a data-identifyelement=\"693\" href=\"https://support.sippysoft.com/solution/articles/3000041461-do-not-call-list-dnc-dncl-\" rel=\"noreferrer noopener\" target=\"_blank\">here</a>.&nbsp;</p><p data-identifyelement=\"694\"><br data-identifyelement=\"695\"></p><h2 data-identifyelement=\"696\"><span style=\"font-size: 24px;\">Changes made in Sippy 2020</span></h2><p data-identifyelement=\"697\"><br data-identifyelement=\"698\"></p><p data-identifyelement=\"699\">In our Sippy 2020 release we have made some changes to added some attributes that are used to handle account authentication:</p><ul><li data-identifyelement=\"699\">To domain (hostname in To: header of incoming INVITE)</li><li data-identifyelement=\"699\">From Domain (hostname in From: header of incoming INVITE)</li></ul><p>In example below <strong>From domain</strong> would be <strong>123abc.from.com</strong></p><div><pre contenteditable=\"false\" data-code-brush=\"Xml\" rel=\"highlighter\">From: \"Mr John Smith\" &lt;sip:123abc123-test@123abc.from.com:1036;user=some-id&gt;;tag=43165asdgw3001</pre><p><br></p></div><p data-identifyelement=\"702\"><span style=\"font-size: 16px;\">Lets introduce an order of preference for attributes:</span></p><ol data-identifyelement=\"703\" style=\"margin: 12px 0px 0px; padding: 0px 0px 0px 40px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\"><li data-identifyelement=\"704\">CLD</li><li data-identifyelement=\"705\" style=\"margin-top: 4px;\">CLI</li><li data-identifyelement=\"706\" style=\"margin-top: 4px;\">remote_ip</li><li data-identifyelement=\"707\" style=\"margin-top: 4px;\"><strong data-identifyelement=\"708\">To domain</strong></li><li data-identifyelement=\"709\" style=\"margin-top: 4px;\"><strong data-identifyelement=\"710\">From domain</strong></li></ol><p data-identifyelement=\"711\" style=\"margin: 12px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\"><strong>Rules to match the attributes.</strong></p><ol data-identifyelement=\"712\" style=\"margin: 12px 0px 0px; padding: 0px 0px 0px 40px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\"><li data-identifyelement=\"713\">If there is a matching rule which contains a CLD then any other rules with empty CLD are skipped.</li><li data-identifyelement=\"714\" style=\"margin-top: 4px;\">Among the rules which passed the CLD check a rule which contains matching CLI beats any rule with empty CLI.</li><li data-identifyelement=\"715\" style=\"margin-top: 4px;\">And so on...</li></ol><p data-identifyelement=\"716\" style=\"margin: 12px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\"><strong>Phone number matching (CLI, CLD)</strong></p><ol data-identifyelement=\"717\" style=\"margin: 12px 0px 0px; padding: 0px 0px 0px 40px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\"><li data-identifyelement=\"718\">If there is a matching rule which contains exact value then all rules with '*' or '?' chars in the value are skipped. If the winner is not determined, next step applies.</li><li data-identifyelement=\"720\">If there is a matching rule which contains symbol '*' it is beaten by any rule that does not contain such symbol. Still remaining rules are passed to next step.</li><li data-identifyelement=\"719\" style=\"margin-top: 4px;\">Among two rules wins the rule which pattern has more non question mark characters.</li></ol><p><br></p><p data-identifyelement=\"721\" style=\"margin: 12px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\"><strong>Domain matching</strong></p><ol><li data-identifyelement=\"722\" style=\"margin-top: 12px; margin-right: 0px; margin-bottom: 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\">A domain can be either exact, e.g. 'domain.com' or can be a suffix match: '*.domain.com', there is no prefix matching for domains.&nbsp;</li><li data-identifyelement=\"722\" style=\"margin-bottom: 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-weight: 400; text-align: start; text-indent: 0px;\">If there is a matching rule with an exact domain then all rules with suffix match are skipped.</li><li data-identifyelement=\"719\">Among two rules with <u>'*'</u> symbol wins the longest rule</li></ol><p data-identifyelement=\"723\" style=\"margin: 12px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\">The suffix matching is literal (unlike DNS zone match). For example the rule '*.domain.com' matches the 'test.domain.com' but does not match 'domain.com'. The rule '*domain.com' matches both 'test.domain.com' and 'domain.com'. The domain part of a SIP URL is not analyzed and if it is in fact an IP address then it is used as is.</p><p data-identifyelement=\"724\" style=\"margin: 12px 0px 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial;\">The new behavior added in our Sippy 2020 release also allows for legacy authentication attribute order to be respected. &nbsp;There is a system configuration setting under \"system/sip/authentication/attr_order\" allowing for parameters:</p><ul data-identifyelement=\"725\"><li data-identifyelement=\"726\" style=\"margin-top: 12px; margin-right: 0px; margin-bottom: 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\">\"default\" - equivalent to \"cld,cli,remote_ip,to_domain,from_domain\"</li><li data-identifyelement=\"727\" style=\"margin-top: 12px; margin-right: 0px; margin-bottom: 0px; padding: 0px; color: rgb(23, 43, 77); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\">\"old_style\" - equivalent to \"weight,to_domain,from_domain\".</li></ul><p data-identifyelement=\"728\"><br data-identifyelement=\"729\"></p><p data-identifyelement=\"730\">It is possible in Sippy 2020 versions and greater to be able to create custom order of these attributes. &nbsp;If you are upgrading to 2020 your authentication methods will be set to \"old_style\". &nbsp;At the present time this change must be handled by contacting our support team.</p><h3 data-identifyelement=\"731\"><br data-identifyelement=\"732\"><strong data-identifyelement=\"733\">Additional Reading</strong></h3><div data-identifyelement=\"734\"><strong data-identifyelement=\"735\">-&nbsp;</strong><a data-identifyelement=\"736\" href=\"http://support.sippysoft.com/solution/articles/77869-understanding-number-translation\" rel=\"noreferrer noopener\" style=\"line-height: 16px;\" target=\"\">Understanding Number Translation</a> - How to perform CLI/CLD Translations for prefix and number manipulation.</div><p data-identifyelement=\"737\"><strong data-identifyelement=\"738\">-</strong> <a data-identifyelement=\"739\" href=\"http://support.sippysoft.com/solution/articles/89038-configuring-your-new-softswitch\" rel=\"noreferrer noopener\" style=\"line-height: 16px;\" target=\"\">Configuring your new Softswitch</a> - Configuring Sippy to pass calls through Softswitch using Digest Authentication.</p><div data-identifyelement=\"734\"><strong data-identifyelement=\"735\">-&nbsp;</strong><a data-identifyelement=\"736\" href=\"https://support.sippysoft.com/en/support/solutions/articles/3000063563-test-dialplan\" style=\"line-height: 16px;\">Test Dialplan</a> - <span style=\"color: rgb(24, 50, 71); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;  text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;\">Check the configuration of the system on how an incoming call is expected to be authenticated and routed within the system, with all charges applied.</span></div><p data-identifyelement=\"740\"><strong data-identifyelement=\"741\"><br data-identifyelement=\"742\"></strong></p></div>",
  "description_text": "   Understanding Authentication  Authentication is the process of establishing association between an incoming call and an Account in the system. There are two basic methods for performing Authentication in the Softswitch: using secure SIP digest and using Authentication Rules. The two methods are described in detail below. Note that both methods can be combined together to provide advanced features (see DID assigning example below).     Sippy Softswitch uses the following authentication chain sequentially         When any call comes into the Softswitch, the very first place the system tries to find an acceptable authentication match is the DID Pool section \u00a0  If a match for the incoming call is not found in the DID's authentication rules, the System checks all available authentication rules under Accounts \u00a0  If there is no matched rule in the authentication rules of any Account, the system sends a \"401 Unauthorized\" response to the remote device with a \"WWW-Authenticate\" for the digest authentication\u00a0 \u00a0  If the remote end provides the correct credentials for the digest authentication, the system authenticates the call and proceeds with the authorization process.      Secure SIP Digest-based Authentication   For this type of authentication, a call is mapped into the Account by performing secure SIP digest authentication. In practice that means that the device or software that originates the call has a username and password configured and that those parameters are matched against the VoIP Login and VoIP Password parameters of all Accounts until a match is found.  Only this type of authentication allows a SIP device to register itself with the Softswitch, providing the requirements for receiving on-net calls.  The primary use of this Authentication method is to facilitate the connection of SIP phones and ATAs to the softswitch.     Rules-based Authentication   For this type of authentication, a call is mapped into the Account by matching four parameters of the incoming call against one or more Authentication Rules associated with the Account. \u00a0Below are the four parameters matched:   IP address of the device or server that originates the call  Calling Number / ANI (CLI)  Called Number / Destination Number (CLD)  Protocol (SIP, H.323, IAX2, Calling Card PIN)      The first three protocols check the match of incoming traffic to the parameter used in the rule. \u00a0The Calling Card PIN is used only when the IVR application is used, and the card number (PIN) is requested.  The system first checks the match of the number entered against the username/voip login of any Account in the system. \u00a0If no match is found, the Authentication Rules, Protocol, and Calling Card PIN are checked for the match.     In order for the call to match the rule, each of the four parameters of the call must match with the appropriate parameter of at least one Authentication Rule. \u00a0When one parameter or Rule is empty only the remaining parameters are matched against incoming calls (Protocol can never be empty)  For example: \u00a0The first rule will match any call originated from IP address 1.2.3.4, CLI 567890 and any CLD. \u00a0The second rule will match calls with CLD 123456789 and any CLI coming from any IP.   #  Remote IP Address  Incoming CLI/ANI  Incoming CLD/DNIS  1  1.2.3.4  567890     2        123456789       Regular Expressions use:    Match any sequence of symbols in the whole number   Using a wildcard (*) in the Incoming CLI and Incoming CLD fields after the number, will result in prefix matching.\u00a0  For example the following modification of the first rule above will match any call originated from IP address 1.2.3.4 and any CLI starting with 567890 (e.g. 567890123).      #  Remote IP Address   Incoming CLI/ANI   \u00a0Incoming CLD/DNIS  1  1.2.3.4  567890*        Note: a wildcard can match the absence of symbols, so the 567890* rule will match 567890 CLI as well.      Match any symbol in any place of the number (starting from version 5.2)   This pattern can be set in the Incoming CLI and Incoming CLD fields by placing a question mark ('?') within the number. \u00a0The result will be number matching where the question mark matches any symbol in the incoming number.  For example: the rule below will match any call originated from IP address 1.2.3.4 and any CLI that starts with 567, is followed by any symbol, followed by 90 and any other symbol (e.g. 5678901 or 5670903).      #  Remote IP Address   Incoming CLI/ANI   \u00a0Incoming CLD/DNIS  1  1.2.3.4  567?90?        Note: the question mark CANNOT match the absence of a symbol, so the 567?90? rule will NOT match either 567890 or 567901 numbers.        Weight distribution for authentication rules (Sippy Softswitch v5.2 and before)      When performing the match against several concurrent Rules, the softswitch also calculates so-called weights for each matching Rule in order to determine the best match. The formula is as follows:    1. Matching IP address adds 1.0 to the resulting weight 2. Matching non-wildcard, CLD or CLI adds 1.5 to the resulting weight 3. Matching wildcard, CLD or CLI adds 1.0 to the resulting weight 4. For any matching wildcard, CLI or CLD the resulting weight is increased by the length of the matching part divided by 100 5. For any question mark, CLI or CLD, the resulting weight is decreased by 0.001 If a wildcard is present in the matching CLI or CLD, the question mark is considered a regular symbol to be added to the weight accordingly   For example, if a call from IP address 1.2.3.4, CLI 567890 and CLD 123456789 arrives, the weights would be calculated as follows:     #  Remote IP Address  Incoming CLI/ANI  Incoming CLD/DNIS  Weight  1  1.2.3.4  567890     1.0+1.5=2.5  2        123456789  1.5  3  1.2.3.4  567890*     1.0+1.0+(6/100)=2.06  4     567?9*     1-0.001+0.05=1.049        Based on the example above, rule 1 would be selected as the best match.\u00a0  Note that if there are multiple rules with the same weight that can be considered \"best\" match, they will be rejected (due to ambiguity) if they use an Authentication rule; in this case, only Digest Authentication would be possible. \u00a0The error message \"401 Unauthorized\" is used when there is ambiguity. \u00a0     Typical Applications for Rules-based Authentication   Rules-based Authentication can accommodate different real-world scenarios. \u00a0Sample of scenarios and steps to implement them are listed below:   VoIP Peering. \u00a0Enter IP address of your peer\u2019s softswitch into the Remote IP Address field  PSTN origination. \u00a0Enter IP address of the gateway into the Remote IP Address field. \u00a0If there are multiple gateways several rules with different IP addresses can be added  Assigning DID numbers. \u00a0DID (Direct Inward Dialing) can be implemented by combining secure SIP digest authentication with one or more Authentication Rules that contain the DID number (as CLD) from the originating gateway. \u00a0Optionally, the Remote IP Address can be used to only allow calls (considered DID calls) from a specific gateway. \u00a0It may be necessary to apply a Translation Rule to ensure proper routing of the call to the registered Account.      Accessing Authentication Rules   To access the Authentication Rules for a particular Account, navigate to the Account's menu, click on the Actions for specific Account. \u00a0Authentication Rules is an action relating to the Account.             Authentication Rules to block Individual Numbers  It is possible to manage this yourself, the method is as follows:     Adding a few numbers and maintaining a fairly simple list can be done manually by changing the Authentication Rules for the specific Account. This can be done PER NUMBER or by blocking an entire country/city (or carrier) code.     Example if you aimed to block calls going to CLI = 92321234567   Create an Account with any Service Plan and Routing Group  Add an Authentication Rule for the Account that uses CLI = 92321234567 if you need to block calls based on NPA/NXX - you can also add a rule such as: 9232* whereby all calls to 9232 xxx xxxx are blocked   You can also manage Authentication Rules using the XML APIs - the support team can provide you details on the correct XML API syntax.     Note that calls dropped using the method above will show SIP error: \"403 Auth Failed\" and will not be written to the CDRs. \u00a0     While the solution works in limited numbers we do offer a Do Not Call List module that is far more effective for managing blocked calls. \u00a0You can read up more about this solution here.\u00a0     Changes made in Sippy 2020     In our Sippy 2020 release we have made some changes to added some attributes that are used to handle account authentication:   To domain (hostname in To: header of incoming INVITE)  From Domain (hostname in From: header of incoming INVITE)   In example below From domain would be 123abc.from.com   From: \"Mr John Smith\" <sip:123abc123-test@123abc.from.com:1036;user=some-id>;tag=43165asdgw3001      Lets introduce an order of preference for attributes:   CLD  CLI  remote_ip  To domain  From domain   Rules to match the attributes.   If there is a matching rule which contains a CLD then any other rules with empty CLD are skipped.  Among the rules which passed the CLD check a rule which contains matching CLI beats any rule with empty CLI.  And so on...   Phone number matching (CLI, CLD)   If there is a matching rule which contains exact value then all rules with '*' or '?' chars in the value are skipped. If the winner is not determined, next step applies.  If there is a matching rule which contains symbol '*' it is beaten by any rule that does not contain such symbol. Still remaining rules are passed to next step.  Among two rules wins the rule which pattern has more non question mark characters.      Domain matching   A domain can be either exact, e.g. 'domain.com' or can be a suffix match: '*.domain.com', there is no prefix matching for domains.\u00a0  If there is a matching rule with an exact domain then all rules with suffix match are skipped.  Among two rules with '*' symbol wins the longest rule   The suffix matching is literal (unlike DNS zone match). For example the rule '*.domain.com' matches the 'test.domain.com' but does not match 'domain.com'. The rule '*domain.com' matches both 'test.domain.com' and 'domain.com'. The domain part of a SIP URL is not analyzed and if it is in fact an IP address then it is used as is.  The new behavior added in our Sippy 2020 release also allows for legacy authentication attribute order to be respected. \u00a0There is a system configuration setting under \"system/sip/authentication/attr_order\" allowing for parameters:   \"default\" - equivalent to \"cld,cli,remote_ip,to_domain,from_domain\"  \"old_style\" - equivalent to \"weight,to_domain,from_domain\".      It is possible in Sippy 2020 versions and greater to be able to create custom order of these attributes. \u00a0If you are upgrading to 2020 your authentication methods will be set to \"old_style\". \u00a0At the present time this change must be handled by contacting our support team.   Additional Reading  -\u00a0Understanding Number Translation - How to perform CLI/CLD Translations for prefix and number manipulation.  - Configuring your new Softswitch - Configuring Sippy to pass calls through Softswitch using Digest Authentication.  -\u00a0Test Dialplan - Check the configuration of the system on how an incoming call is expected to be authenticated and routed within the system, with all charges applied.     ",
  "seo_data": {
    "meta_title": "",
    "meta_description": "",
    "meta_keywords": ""
  },
  "tags": [
    "Authentication",
    "IP to IP",
    "Authentication Rules",
    "Blocked Call",
    "CLI",
    "ANI",
    "CLI/ANI Matching"
  ],
  "attachments": [],
  "cloud_files": [],
  "thumbs_up": 12,
  "thumbs_down": 7,
  "hits": 5769,
  "suggested": 0,
  "feedback_count": 0,
  "collaboration": {
    "convo_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJUeXBlIjoiYXJ0aWNsZSIsIkNvbnZvSWQiOiI3NzU1My1lbiIsIlVzZXJJZCI6IjMwMTIwODk1MjQiLCJleHAiOjE2MzUzNzEwMjR9.3oVRuAdjaLsoU8FV9WrCOGiVleanScPFPisAq0JakFY"
  }
}